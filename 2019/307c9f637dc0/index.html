<!DOCTYPE html><html lang="[&quot;zh-CN&quot;,&quot;default&quot;]" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>Redis缓存 | Jeremy</title><meta name="author" content="Jeremyhzf"><meta name="copyright" content="Jeremyhzf"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="一、缓存的使用为了提升系统性能，我们一般都会将部分数据放入缓存，加速访问。 适合放入缓存的数据：  即时性、数据一致性要求不高的数据（如分类信息、Cookie） 访问量大且更新频率不高的数据（读多写少）  举例：电商类应用，商品分类、商品列表、物流状态信息等适合加缓存并加一个失效时间"><meta property="og:type" content="article"><meta property="og:title" content="Redis缓存"><meta property="og:url" content="https://jeremyhzf.com/2019/307c9f637dc0/index.html"><meta property="og:site_name" content="Jeremy"><meta property="og:description" content="一、缓存的使用为了提升系统性能，我们一般都会将部分数据放入缓存，加速访问。 适合放入缓存的数据：  即时性、数据一致性要求不高的数据（如分类信息、Cookie） 访问量大且更新频率不高的数据（读多写少）  举例：电商类应用，商品分类、商品列表、物流状态信息等适合加缓存并加一个失效时间"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://jeremyhzf.com/transparent"><meta property="article:published_time" content="2019-10-22T03:13:37.000Z"><meta property="article:modified_time" content="2019-10-22T03:13:37.000Z"><meta property="article:author" content="Jeremyhzf"><meta property="article:tag" content="缓存"><meta property="article:tag" content="Redis"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://jeremyhzf.com/transparent"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://jeremyhzf.com/2019/307c9f637dc0/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:void 0,translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!0,islazyload:!1,isAnchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Redis缓存",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2019-10-22 11:13:37"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,a){0!==a&&(a=864e5*a,t={value:t,expiry:(new Date).getTime()+a},localStorage.setItem(e,JSON.stringify(t)))},get:function(e){var t=localStorage.getItem(e);if(t){t=JSON.parse(t);if(!((new Date).getTime()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=o=>new Promise((t,e)=>{const a=document.createElement("script");a.src=o,a.async=!0,a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};e=saveToLocal.get("theme"),"dark"===e?activateDarkMode():"light"===e&&activateLightMode(),e=saveToLocal.get("aside-status");void 0!==e&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="Jeremy" type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">21</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">23</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">20</div></a></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background:0 0"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jeremy</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Redis缓存</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2019-10-22T03:13:37.000Z" title="发表于 2019-10-22 11:13:37">2019-10-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2019-10-22T03:13:37.000Z" title="更新于 2019-10-22 11:13:37">2019-10-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%93%E5%AD%98/">缓存</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Redis/">Redis</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Redis缓存"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="一、缓存的使用"><a href="#一、缓存的使用" class="headerlink" title="一、缓存的使用"></a>一、缓存的使用</h2><p>为了提升系统性能，我们一般都会将部分数据放入缓存，加速访问。</p><p>适合放入缓存的数据：</p><ol><li><strong>即时性、数据一致性要求不高的数据</strong>（如分类信息、Cookie）</li><li><strong>访问量大且更新频率不高的数据</strong>（读多写少）</li></ol><p>举例：电商类应用，商品分类、商品列表、物流状态信息等适合加缓存并加一个失效时间</p><span id="more"></span><h2 id="二、缓存失效问题（缓存穿透、击穿、雪崩）"><a href="#二、缓存失效问题（缓存穿透、击穿、雪崩）" class="headerlink" title="二、缓存失效问题（缓存穿透、击穿、雪崩）"></a>二、缓存失效问题（缓存穿透、击穿、雪崩）</h2><h3 id="1-缓存穿透"><a href="#1-缓存穿透" class="headerlink" title="1. 缓存穿透"></a>1. 缓存穿透</h3><p><strong>描述</strong>：缓存穿透是指缓存和数据库中都没有的数据，而用户不断发起请求，如发起为id为“-1”的数据或id为特别大不存在的数据。这时的用户很可能是攻击者，攻击会导致数据库压力过大。</p><p><strong>风险</strong>：利用不存在的数据进行攻击，数据库压力瞬间增大，最终导致崩溃。</p><p><strong>解决</strong>：</p><ol><li><p>接口层增加校验，如用户鉴权校验，id做基础校验，id&lt;=0的直接拦截；</p></li><li><p>null结果缓存，并加入短暂过期时间。这样可以防止攻击用户反复用同一个id暴力攻击；</p></li><li><p>采用布隆过滤器，将所有可能存在的数据哈希到一个足够大的bitmap中，一个一定不存在的数据会被这个bitmap拦截掉，从而避免了对底层存储系统的查询压力。</p></li></ol><h3 id="2-缓存击穿"><a href="#2-缓存击穿" class="headerlink" title="2. 缓存击穿"></a>2. 缓存击穿</h3><p><strong>描述</strong>：缓存击穿是指缓存中的一些热点Key数据失效，这时由于瞬时并发特别高，同时读缓存没读到数据，又同时去数据库去取数据，引起数据库压力瞬间增大，造成过大压力。</p><p><strong>风险</strong>：数据库压力过大甚至down机。</p><p><strong>解决</strong>：</p><ol><li>设置热点数据永远不过期；</li><li>加互斥锁：大量并发只让一个请求去查询数据库，其他请求等待，查到数据放入缓存后释放锁，其他人获取锁后先查缓存，缓存就会有数据，不用去查DB； 最好能根据Key加锁。</li></ol><p>​ 加锁流程： 查询缓存 -&gt; 加锁（设置过期时间） -&gt; 查询缓存 -&gt; 查询数据库 -&gt; 放入缓存 -&gt; 释放锁 -&gt; 返回结果</p><h3 id="3-缓存雪崩"><a href="#3-缓存雪崩" class="headerlink" title="3.缓存雪崩"></a>3.缓存雪崩</h3><p><strong>描述</strong>：缓存雪崩是指缓存中大批量数据设置相同的过期时间，导致缓存在每一时刻同时失效，请求全部转到DB，引起数据库压力过大甚至down机。</p><p>和缓存击穿不同的是，缓存击穿指并发查同一条数据，缓存雪崩是不同数据都过期了，很多数据都查不到从而查数据库。</p><p><strong>风险</strong>：数据库压力过大甚至down机。</p><p><strong>解决</strong>：</p><ol><li>缓存数据的过期时间基础上增加一个随机时间，防止同一时间大量数据过期现象发生。</li><li>如果缓存数据库是分布式部署，将热点数据均匀分布在不同搞得缓存数据库中。</li><li>设置热点数据（频繁使用的数据）永远不过期。</li></ol><h2 id="三、缓存数据一致性问题"><a href="#三、缓存数据一致性问题" class="headerlink" title="三、缓存数据一致性问题"></a>三、缓存数据一致性问题</h2><h3 id="1-双写模式"><a href="#1-双写模式" class="headerlink" title="1.双写模式"></a>1.双写模式</h3><p><strong>定义</strong>：数据库写完数据(新增或修改)、写缓存。</p><p><strong>问题</strong>：并发修改的时候可能会出现<strong>暂时性的脏数据问题</strong>，但是在数据稳定、缓存过期之后又可以得到最新的正确数据。<strong>双写模式只能保证数据最终一致性</strong>。</p><p><strong>例子</strong>：写数据库(线程1) -&gt; 写数据库(线程2) -&gt; 写缓存(线程2) -&gt; 写缓存(线程1)</p><p><strong>解决</strong>：加锁（通常加读写锁），写数据库和写缓存整个流程加上锁。并且所有缓存有过期时间。</p><h3 id="2-失效模式"><a href="#2-失效模式" class="headerlink" title="2.失效模式"></a>2.失效模式</h3><p><strong>定义</strong>：数据库写完数据(新增或修改)、删除缓存中的数据。</p><p><strong>问题</strong>：并发修改的情况下也会出现脏数据问题</p><p><strong>解决</strong>：加锁（通常加读写锁）</p><h3 id="3-解决缓存一致性问题"><a href="#3-解决缓存一致性问题" class="headerlink" title="3.解决缓存一致性问题"></a>3.解决缓存一致性问题</h3><p>无论是双写模式还是失效模式，高并发情况下都有可能导致缓存的不一致问题。</p><p>我们应该通过系统设计来解决。</p><ol><li>放入缓存的数据不应该是实时性、一致性要求很高的数据，所以给缓存加上过期时间，保证最一致性就行。</li><li>实时性、一致性要求高的数据，可以直接查数据库。实在要求放缓存可以采用canal订阅binlog的方式。</li></ol><p><strong>采用canal订阅binlog的方式可以完美解决缓存不一致问题，但会增加系统设计的复杂性。</strong></p><h2 id="四、缓存工具"><a href="#四、缓存工具" class="headerlink" title="四、缓存工具"></a>四、缓存工具</h2><p><strong>本地缓存</strong>：Caffeine 、 Guava Cache</p><p><strong>分布式缓存</strong>：redis、memcached</p><h2 id="五、分布式锁"><a href="#五、分布式锁" class="headerlink" title="五、分布式锁"></a>五、分布式锁</h2><p>常见实现方案： <code>zookeeper</code>、<code>redis</code></p><h4 id="1、zookeeper"><a href="#1、zookeeper" class="headerlink" title="1、zookeeper"></a>1、zookeeper</h4><blockquote><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/51b8280117ca">https://www.jianshu.com/p/51b8280117ca</a></p></blockquote><p><strong>大致思想</strong>： 每个客户端对某个方法加锁时，在 Zookeeper 上与该方法对应的指定节点的目录下，<strong>生成一个唯一的临时有序节点</strong>。判断是否获取锁的方式很简单，只需要判断有序节点中<strong>序号最小的一个</strong>。当释放锁的时候，只需将这个临时节点删除即可。同时，其可以避免服务宕机导致的锁无法释放，而产生的死锁问题。</p><p>优点：</p><ul><li>有效的解决单点问题，不可重入问题，非阻塞问题以及锁无法释放的问题</li><li>实现较为简单</li></ul><p>缺点：</p><ul><li>性能上不如使用缓存实现的分布式锁，因为每次在创建锁和释放锁的过程中，都要动态创建、销毁临时节点来实现锁功能</li><li>需要对Zookeeper的原理有所了解</li></ul><p><strong>排他锁</strong></p><ul><li><code>定义锁</code>：通过Zookeeper上的数据节点来表示一个锁。</li><li><code>获取锁</code>：客户端通过调用 <code>create</code> 方法创建表示锁的临时节点，可以认为创建成功的客户端获得了锁，同时可以让没有获得锁的节点在该节点上注册Watcher监听，以便实时监听到lock节点的变更情况。</li><li><code>释放锁</code>：以下两种情况都可以让锁释放：<pre><code>  1. 当前获得锁的客户端发生宕机或异常，那么Zookeeper上这个临时节点就会被删除；
     2. 正常执行完业务逻辑，客户端主动删除自己创建的临时节点；
</code></pre></li></ul><p><strong>共享锁</strong></p><ul><li><p><code>定义锁</code>：通过Zookeeper上的数据节点来表示一个锁，是一个类似于 <code>/lockpath/[hostname]-请求类型-序号</code>的临时顺序节点</p></li><li><p><code>获取锁</code>：客户端通过调用 <code>create</code> 方法创建表示锁的临时顺序节点，如果是读请求，则创建 <code>/lockpath/[hostname]-R-序号</code> 节点，如果是写请求则创建 <code>/lockpath/[hostname]-W-序号</code> 节点</p></li><li><p><code>判断读写顺序</code>：大概分为4个步骤:</p><ol><li><p>创建完节点后，获取 <code>/lockpath</code> 节点下的所有子节点，并对该节点注册子节点变更的Watcher监听</p></li><li><p>确定自己的节点序号在所有子节点中的顺序</p></li><li><p>对于读请求：1. 如果没有比自己序号更小的子节点，或者比自己序号小的子节点都是读请求，那么表明自己已经成功获取到了共享锁，同时开始执行读取逻辑 2. 如果有比自己序号小的子节点有写请求，那么等待 。</p><p>对于写请求：如果自己不是序号最小的节点，那么等待。</p></li><li><p>接收到Watcher通知后，重复步骤1)</p></li></ol></li><li><p><code>释放锁</code>：与排他锁逻辑一致</p></li></ul><h4 id="2、redis"><a href="#2、redis" class="headerlink" title="2、redis"></a>2、redis</h4><p><strong><code>redis</code>分布式锁一般使用高级封装框架<code>Redisson</code></strong></p><blockquote><p>redis官方文档： <a target="_blank" rel="noopener" href="https://redis.io/topics/distlock">https://redis.io/topics/distlock</a></p></blockquote><p>1、加锁：使用<code>SETNX</code>原子性加锁，设置过期时间、并为每个竞争锁的节点加上唯一标识（UUID、token）</p><p>2、解锁：使用redis官方提供的lua脚本原子性解锁</p><p><strong>基于缓存实现分布式锁总结</strong></p><p>优点：</p><ul><li>性能好</li></ul><p>缺点：</p><ul><li>实现中需要考虑的因素太多</li><li>通过超时时间来控制锁的失效时间并不是十分的靠谱</li></ul></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://jeremyhzf.com">Jeremyhzf</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://jeremyhzf.com/2019/307c9f637dc0/">https://jeremyhzf.com/2019/307c9f637dc0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://jeremyhzf.com" target="_blank">Jeremy</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%BC%93%E5%AD%98/">缓存</a><a class="post-meta__tags" href="/tags/Redis/">Redis</a></div><div class="post_share"><div class="social-share" data-image="/transparent" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/d6ad00b58435/"><img class="prev-cover" src="https://jeremyhzf-blog.oss-cn-hongkong.aliyuncs.com/Hadoop.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Hadoop调优</div></div></a></div><div class="next-post pull-right"><a href="/2019/34ce46a43564/"><img class="next-cover" src="https://jeremyhzf-blog.oss-cn-hongkong.aliyuncs.com/Nginx.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Nginx配置详解</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E7%BC%93%E5%AD%98%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">一、缓存的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E7%BC%93%E5%AD%98%E5%A4%B1%E6%95%88%E9%97%AE%E9%A2%98%EF%BC%88%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F%E3%80%81%E5%87%BB%E7%A9%BF%E3%80%81%E9%9B%AA%E5%B4%A9%EF%BC%89"><span class="toc-text">二、缓存失效问题（缓存穿透、击穿、雪崩）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%BC%93%E5%AD%98%E7%A9%BF%E9%80%8F"><span class="toc-text">1. 缓存穿透</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%BC%93%E5%AD%98%E5%87%BB%E7%A9%BF"><span class="toc-text">2. 缓存击穿</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%BC%93%E5%AD%98%E9%9B%AA%E5%B4%A9"><span class="toc-text">3.缓存雪崩</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%BC%93%E5%AD%98%E6%95%B0%E6%8D%AE%E4%B8%80%E8%87%B4%E6%80%A7%E9%97%AE%E9%A2%98"><span class="toc-text">三、缓存数据一致性问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8F%8C%E5%86%99%E6%A8%A1%E5%BC%8F"><span class="toc-text">1.双写模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A4%B1%E6%95%88%E6%A8%A1%E5%BC%8F"><span class="toc-text">2.失效模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%A7%A3%E5%86%B3%E7%BC%93%E5%AD%98%E4%B8%80%E8%87%B4%E6%80%A7%E9%97%AE%E9%A2%98"><span class="toc-text">3.解决缓存一致性问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%BC%93%E5%AD%98%E5%B7%A5%E5%85%B7"><span class="toc-text">四、缓存工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81"><span class="toc-text">五、分布式锁</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E3%80%81zookeeper"><span class="toc-text">1、zookeeper</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E3%80%81redis"><span class="toc-text">2、redis</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By Jeremyhzf</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>